import{az as I,aA as J,r as m,c as H,f as O,k as j,ag as p,y as _,z as g,A as e,P as o,H as n,a5 as Q,u as l,L as d,M as r,K as S,O as z,a4 as B,G as W,J as X}from"./vendors-75826026.js";import{_ as Y,u as Z}from"./_plugin-vue_export-helper-4c6240b9.js";import{E as f,s as ee,r as te,c as T}from"./element-plus-5e60ac94.js";const se={class:"home"},oe={class:"header"},ae={class:"search-section"},ne={class:"search-bar"},le={key:0,class:"random-recommend"},ie={class:"section-title"},ce={class:"recipe-image"},re=["src","alt"],de={class:"recipe-overlay"},ue={class:"cooking-time"},me={class:"recipe-info"},_e={class:"recipe-tags"},pe={class:"category-shortcuts"},ge={class:"shortcut-grid"},he=["onClick"],ve={class:"today-recommends"},fe={class:"recommend-grid"},ye=["onClick"],Ce={class:"recommend-image"},ke=["src","alt"],we={class:"recommend-overlay"},Re={class:"cooking-time"},xe={class:"recommend-info"},He={class:"recommend-tags"},Pe={key:1,class:"load-more"},Ve={__name:"Home",setup(Le){const k=I(),u=Z(),{homePageRecipe:c,homePageRecommends:w}=J(u),h=m(""),P=m(!1),y=m([]);m([]);const R=m(!1),x=m(!0),C=m(1);H(()=>y.value.filter(t=>t.type==="dish")),H(()=>y.value.filter(t=>t.type==="ingredient")),H(()=>y.value.filter(t=>t.type==="time"));const V=async()=>{try{u.resetHomePageRecipe(),await u.getHomePageRecipe()}catch{f.error("获取推荐失败，请稍后重试")}},N=async()=>{try{await u.getHomePageRecommends()}catch{f.error("获取今日推荐失败，请稍后重试")}},L=t=>{k.push(`/recipe/${t}`)};O(h,async t=>{t.trim()?(y.value=await b(t),P.value=!0):P.value=!1});const b=async t=>{const s=[];return s.push({id:1,text:"红烧肉",type:"dish",category:"肉类"},{id:2,text:"清炒西兰花",type:"dish",category:"素菜"}),s.push({id:3,text:"五花肉",type:"ingredient"},{id:4,text:"西兰花",type:"ingredient"}),(t.includes("分钟")||/\d+/.test(t))&&s.push({id:5,text:"快速料理",type:"time",duration:"15分钟以内"},{id:6,text:"常规烹饪",type:"time",duration:"15-30分钟"}),s.filter(i=>i.text.toLowerCase().includes(t.toLowerCase())||i.category&&i.category.toLowerCase().includes(t.toLowerCase())||i.duration&&i.duration.toLowerCase().includes(t.toLowerCase()))},K=()=>{if(!h.value.trim()){f.warning("请输入搜索内容");return}k.push({path:"/search",query:{keyword:h.value.trim()}})},$=[{id:1,name:"早餐",icon:"Coffee"},{id:2,name:"午餐",icon:"Bowl"},{id:3,name:"晚餐",icon:"Food"},{id:4,name:"小食",icon:"Apple"},{id:5,name:"汤品",icon:"Bowl"},{id:6,name:"肉类",icon:"Chicken"},{id:7,name:"素食",icon:"Food"},{id:8,name:"饮品",icon:"Coffee"}],A=async()=>{try{await Promise.all([V(),N()]),C.value=1,x.value=!0}catch{f.error("刷新失败，请稍后重试")}finally{R.value=!1}},D=async()=>{try{C.value++,await u.getMoreRecommends(C.value),x.value=w.value.length<30}catch{f.error("加载更多失败，请稍后重试"),C.value--}},E=t=>{k.push({path:"/category",query:{id:t.id,name:t.name}})};return j(async()=>{var t;c.value||await u.getHomePageRecipe(),(t=w.value)!=null&&t.length||await u.getHomePageRecommends()}),(t,s)=>{const i=p("el-icon"),F=p("el-input"),M=p("el-button"),v=p("el-tag"),q=p("el-card"),U=p("el-pull-refresh");return _(),g("div",se,[e("div",oe,[e("div",ae,[e("div",ne,[o(F,{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=a=>h.value=a),placeholder:"搜索菜品、食材...",class:"search-input",onKeyup:Q(K,["enter"]),clearable:""},{prefix:n(()=>[o(i,null,{default:n(()=>[o(l(ee))]),_:1})]),_:1},8,["modelValue"])])]),s[3]||(s[3]=e("h1",null,"今天吃什么？",-1)),s[4]||(s[4]=e("p",null,"每天为您精选美味佳肴",-1))]),o(U,{modelValue:R.value,"onUpdate:modelValue":s[2]||(s[2]=a=>R.value=a),onRefresh:A},{default:n(()=>[l(c)?(_(),g("div",le,[e("div",ie,[s[6]||(s[6]=e("h2",null,"今日推荐",-1)),o(M,{text:"",onClick:V},{default:n(()=>[o(i,null,{default:n(()=>[o(l(te))]),_:1}),s[5]||(s[5]=d(" 换一个 "))]),_:1})]),o(q,{class:"recipe-card",onClick:s[1]||(s[1]=a=>L(l(c).id))},{default:n(()=>[e("div",ce,[e("img",{src:l(c).image,alt:l(c).name},null,8,re),e("div",de,[e("span",ue,[o(i,null,{default:n(()=>[o(l(T))]),_:1}),d(" "+r(l(c).cookingTime),1)])])]),e("div",me,[e("h3",null,r(l(c).name),1),e("div",_e,[o(v,{size:"small"},{default:n(()=>[d(r(l(c).category),1)]),_:1}),o(v,{size:"small",type:"success"},{default:n(()=>[d(r(l(c).cookingMethod),1)]),_:1}),o(v,{size:"small",type:"warning"},{default:n(()=>[d(r(l(c).difficulty),1)]),_:1})])])]),_:1})])):S("",!0),e("div",pe,[e("div",ge,[(_(),g(z,null,B($,a=>e("div",{key:a.id,class:"shortcut-item",onClick:G=>E(a)},[o(i,{class:"shortcut-icon"},{default:n(()=>[(_(),W(X(a.icon)))]),_:2},1024),e("span",null,r(a.name),1)],8,he)),64))])]),e("div",ve,[s[7]||(s[7]=e("div",{class:"section-title"},[e("h2",null,"精选推荐")],-1)),e("div",fe,[(_(!0),g(z,null,B(l(w),a=>(_(),g("div",{key:a.id,class:"recommend-item",onClick:G=>L(a.id)},[e("div",Ce,[e("img",{src:a.image,alt:a.name},null,8,ke),e("div",we,[e("span",Re,[o(i,null,{default:n(()=>[o(l(T))]),_:1}),d(" "+r(a.cookingTime),1)])])]),e("div",xe,[e("h3",null,r(a.name),1),e("div",He,[o(v,{size:"small"},{default:n(()=>[d(r(a.category),1)]),_:2},1024),o(v,{size:"small",type:"success"},{default:n(()=>[d(r(a.cookingMethod),1)]),_:2},1024)])])],8,ye))),128))])]),x.value?(_(),g("div",Pe,[o(M,{text:"",onClick:D},{default:n(()=>s[8]||(s[8]=[d("加载更多")])),_:1})])):S("",!0)]),_:1},8,["modelValue"])])}}},Be=Y(Ve,[["__scopeId","data-v-8dd0753e"]]);export{Be as default};
