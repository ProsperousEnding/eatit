import{az as e,aA as a,r as s,c as l,f as t,k as i,ag as o,y as c,z as n,A as r,P as d,H as u,a5 as m,u as p,L as v,M as g,K as y,O as h,a4 as f,G as _,J as k}from"./vendors-123bf75d.js";import{_ as w,u as C}from"./_plugin-vue_export-helper-81216463.js";import{E as x,s as P,r as R,c as z}from"./element-plus-f93db08e.js";const H={class:"home"},L={class:"header"},V={class:"search-section"},M={class:"search-bar"},b={key:0,class:"random-recommend"},j={class:"section-title"},A={class:"recipe-image"},q=["src","alt"],B={class:"recipe-overlay"},F={class:"cooking-time"},K={class:"recipe-info"},T={class:"recipe-tags"},U={class:"category-shortcuts"},E={class:"shortcut-grid"},G=["onClick"],I={class:"today-recommends"},J={class:"recommend-grid"},O=["onClick"],$={class:"recommend-image"},D=["src","alt"],N={class:"recommend-overlay"},Q={class:"cooking-time"},S={class:"recommend-info"},W={class:"recommend-tags"},X={key:1,class:"load-more"},Y=w({__name:"Home",setup(w){const Y=e(),Z=C(),{homePageRecipe:ee,homePageRecommends:ae}=a(Z),se=s(""),le=s(!1),te=s([]);s([]);const ie=s(!1),oe=s(!0),ce=s(1);l((()=>te.value.filter((e=>"dish"===e.type)))),l((()=>te.value.filter((e=>"ingredient"===e.type)))),l((()=>te.value.filter((e=>"time"===e.type))));const ne=async()=>{try{Z.resetHomePageRecipe(),await Z.getHomePageRecipe()}catch(e){x.error("获取推荐失败，请稍后重试")}},re=async()=>{try{await Z.getHomePageRecommends()}catch(e){x.error("获取今日推荐失败，请稍后重试")}},de=e=>{Y.push(`/recipe/${e}`)};t(se,(async e=>{e.trim()?(te.value=await ue(e),le.value=!0):le.value=!1}));const ue=async e=>{const a=[];return a.push({id:1,text:"红烧肉",type:"dish",category:"肉类"},{id:2,text:"清炒西兰花",type:"dish",category:"素菜"}),a.push({id:3,text:"五花肉",type:"ingredient"},{id:4,text:"西兰花",type:"ingredient"}),(e.includes("分钟")||/\d+/.test(e))&&a.push({id:5,text:"快速料理",type:"time",duration:"15分钟以内"},{id:6,text:"常规烹饪",type:"time",duration:"15-30分钟"}),a.filter((a=>a.text.toLowerCase().includes(e.toLowerCase())||a.category&&a.category.toLowerCase().includes(e.toLowerCase())||a.duration&&a.duration.toLowerCase().includes(e.toLowerCase())))},me=()=>{se.value.trim()?Y.push({path:"/search",query:{keyword:se.value.trim()}}):x.warning("请输入搜索内容")},pe=[{id:1,name:"早餐",icon:"Coffee"},{id:2,name:"午餐",icon:"Bowl"},{id:3,name:"晚餐",icon:"Food"},{id:4,name:"小食",icon:"Apple"},{id:5,name:"汤品",icon:"Bowl"},{id:6,name:"肉类",icon:"Chicken"},{id:7,name:"素食",icon:"Food"},{id:8,name:"饮品",icon:"Coffee"}],ve=async()=>{try{await Promise.all([ne(),re()]),ce.value=1,oe.value=!0}catch(e){x.error("刷新失败，请稍后重试")}finally{ie.value=!1}},ge=async()=>{try{ce.value++,await Z.getMoreRecommends(ce.value),oe.value=ae.value.length<30}catch(e){x.error("加载更多失败，请稍后重试"),ce.value--}};return i((async()=>{var e;ee.value||await Z.getHomePageRecipe(),(null==(e=ae.value)?void 0:e.length)||await Z.getHomePageRecommends()})),(e,a)=>{const s=o("el-icon"),l=o("el-input"),t=o("el-button"),i=o("el-tag"),w=o("el-card"),C=o("el-pull-refresh");return c(),n("div",H,[r("div",L,[r("div",V,[r("div",M,[d(l,{modelValue:se.value,"onUpdate:modelValue":a[0]||(a[0]=e=>se.value=e),placeholder:"搜索菜品、食材...",class:"search-input",onKeyup:m(me,["enter"]),clearable:""},{prefix:u((()=>[d(s,null,{default:u((()=>[d(p(P))])),_:1})])),_:1},8,["modelValue"])])]),a[3]||(a[3]=r("h1",null,"今天吃什么？",-1)),a[4]||(a[4]=r("p",null,"每天为您精选美味佳肴",-1))]),d(C,{modelValue:ie.value,"onUpdate:modelValue":a[2]||(a[2]=e=>ie.value=e),onRefresh:ve},{default:u((()=>[p(ee)?(c(),n("div",b,[r("div",j,[a[6]||(a[6]=r("h2",null,"今日推荐",-1)),d(t,{text:"",onClick:ne},{default:u((()=>[d(s,null,{default:u((()=>[d(p(R))])),_:1}),a[5]||(a[5]=v(" 换一个 "))])),_:1})]),d(w,{class:"recipe-card",onClick:a[1]||(a[1]=e=>de(p(ee).id))},{default:u((()=>[r("div",A,[r("img",{src:p(ee).image,alt:p(ee).name},null,8,q),r("div",B,[r("span",F,[d(s,null,{default:u((()=>[d(p(z))])),_:1}),v(" "+g(p(ee).cookingTime),1)])])]),r("div",K,[r("h3",null,g(p(ee).name),1),r("div",T,[d(i,{size:"small"},{default:u((()=>[v(g(p(ee).category),1)])),_:1}),d(i,{size:"small",type:"success"},{default:u((()=>[v(g(p(ee).cookingMethod),1)])),_:1}),d(i,{size:"small",type:"warning"},{default:u((()=>[v(g(p(ee).difficulty),1)])),_:1})])])])),_:1})])):y("",!0),r("div",U,[r("div",E,[(c(),n(h,null,f(pe,(e=>r("div",{key:e.id,class:"shortcut-item",onClick:a=>(e=>{Y.push({path:"/category",query:{id:e.id,name:e.name}})})(e)},[d(s,{class:"shortcut-icon"},{default:u((()=>[(c(),_(k(e.icon)))])),_:2},1024),r("span",null,g(e.name),1)],8,G))),64))])]),r("div",I,[a[7]||(a[7]=r("div",{class:"section-title"},[r("h2",null,"精选推荐")],-1)),r("div",J,[(c(!0),n(h,null,f(p(ae),(e=>(c(),n("div",{key:e.id,class:"recommend-item",onClick:a=>de(e.id)},[r("div",$,[r("img",{src:e.image,alt:e.name},null,8,D),r("div",N,[r("span",Q,[d(s,null,{default:u((()=>[d(p(z))])),_:1}),v(" "+g(e.cookingTime),1)])])]),r("div",S,[r("h3",null,g(e.name),1),r("div",W,[d(i,{size:"small"},{default:u((()=>[v(g(e.category),1)])),_:2},1024),d(i,{size:"small",type:"success"},{default:u((()=>[v(g(e.cookingMethod),1)])),_:2},1024)])])],8,O)))),128))])]),oe.value?(c(),n("div",X,[d(t,{text:"",onClick:ge},{default:u((()=>a[8]||(a[8]=[v("加载更多")]))),_:1})])):y("",!0)])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-8dd0753e"]]);export{Y as default};
